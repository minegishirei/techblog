





# アーキテクチャのモジュール化・リファクタリングのメリット

リファクタリングやモジュール化を行う際には、当然ながら費用が発生します。
そしてその費用を承認してもらう際に、ビジネスサイドと折り合いがつかない時があります。

リファクタリングやモジュール化などは**保守業務**の一種であると言われますが、この保守業務を新規案件の時に組み込むことで
承認されやすくなります。
ですが、そうでない場合はアーキテクチャのモジュール化やリファクタリングを行うことのメリットを説明しなければなりません。

つまり、今回の記事の内容としては以下の通りです

- 大規模作業向けの良い提案資料を用意する必要がある

- そしてそのためにアージュテクチャのモジュール化のメリットを理解する必要がある

- メリットを現在直面している課題に対応づける

- アプリケーションを分解することでトレードオフを分析し、文書化する

その前に、**そもそもシステムが変化するモノである**という大前提を有識者に共有しておかなければならない。


# そもそもシステムは常に変化するものである

ITは常に進化している。
計算システムが置かれている技術環境も同様であり、その都度アーキテクチャも進化してきた。
例えば、コンテナ化、クラウドベースのインフラへの移行、DevOpsの採用、CI/CDなどなど。
これらの技術全てがアーキテクチャに影響を与える。

<img src="https://reorganization.nihon-ma.co.jp/wp/wp-content/uploads/image1-1.png">

from https://reorganization.nihon-ma.co.jp/report/743/

ところが、絶え間無く急速に進化しているのは、ITだけではなく、ビジネスだけではない。
今日の市場では、M&Aが盛んに行われているため、ある企業を別の企業が買収することも発生する。
企業の買収が発生した場合、企業の物理的な側面（人、建物、在庫）だけでなく、顧客もより増えることになる。
両者の既存システムは、合併による結合がうまくいくだろうか。

このように、ビジネスでの進化やイベントは、アーキテクチャ上の関心事として大きな意味を持つ。

## リファクタリングが必要となる具体例

例えば、モノシリックなアーキテクチャとマイクロサービスなアーキテクチャではどちらが合併や買収をサポートしやすいだろうか。
これは当然マイクロサービスなアーキテクチャである。

- モノシリックなアーキテクチャは一つのサーバーで全てのシステムの機能を賄うため、「サーバーの限界値＝システムが提供できる機能の限界値」となる。

<img src="https://github.com/kawadasatoshi/techblog/blob/main/0/inhouse_se/layerd1.png?raw=true">

- マイクロサービスなアーキテクチャは複数のサーバーでシステムの機能を賄うため、サーバーを増築することでシステムが提供できる機能の限界は無限である。

<img src="https://github.com/kawadasatoshi/techblog/blob/main/0/inhouse_se/2006space_base_arch/space_base_arch.png?raw=true">

このように、マイクロサービスには事業の成長に合わせたスケーラビリティを持ち合わせるのである。

これらの材料を利害関係者に説明するとこのようなる

*「最近のシステムはマイクロサービスを採用することもあるが、それはごくごく最近のことです。このシステムは10年前に作られたシステムでものシリックなサービスでしたが、当時はユーザー数もそれほどではなかったので十分で耐えられていました。ですが今回のM&Aでユーザー数が10倍に膨れ上がることが予測されます。ビジネスの変化とともにシステムも変化させて柔軟な対応ができるようにマイクロサービスを採用しましょう」*

## アジャイルなビジネスにはアジャイルなシステムが必要

先ほど説明したように**企業の業績が良ければ良いほど、その企業はサイズも含めて成長する** 

そうすると

1. ユーザーアクティビティの増加をサポートするのにより高いスケーラビリティが必要になる

2. また、アプリケーションの一部に障害が発生しても、他の部分は通常通り機能したままとし、エンドユーザーへの全体的な影響を最小限にする耐障害性が必要になる

今日のように急速に変化し続ける市場で生き残るにはビジネスは当然アジャイルでなければならないが、それは基盤となるアーキテクチャもアジャイル出なければならない。

# リファクタリングをするべき5つの理由

- 耐障害性

- スケーラビリティ

- デプロイ性

- テスト性

- 保守性

システムがアジャイルな変化に対応できるモノであるためには、上の5つが条件となる。

このうち、「デプロイ性」と「テスト性」と「保守性」のみはマイクロサービスでなくとも通常のリファクタリングで十分対応可能だ。
ユーザーが大幅に増えるとか、大規模な改修が入る以外ではモノシリックサービスのリファクタリングで良い。

しかし、耐障害性やスケーラビリティはモノシリックアーキテクチャでは対応できない。
前述の通り、モノシリックなアーキテクチャは一つのサーバーで全てのシステムの機能を賄うため、「サーバーの限界値＝システムが提供できる機能の限界値」となるためである。











## 備考

title:リファクタリングをするべき5つの理由






